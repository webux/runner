/*
* uxRunner v.0.1.0
* (c) 2013, WebUX
* License: MIT.
*/
!function(a){function b(){bb&&console.log.apply(console,arguments)}function c(){R.dispatcher?R.dispatcher.dispatch.apply(R.dispatcher,arguments):(Y.rootElement=Y.rootElement||$("body"),Y.rootElement.trigger.apply(Y.rootElement,arguments))}function d(){S=R.getInjector?R.getInjector():{invoke:x},R.locals.injector=S,R.walking=!1,R.exit=!1}function e(){var a={name:"all",type:_.ROOT,label:"E2E Tests",parent:{type:_.ROOT,depth:0,next:function(){b("All Complete"),c(X.DONE)}}};R.steps=T=h(a),a.depth=0,U=T}function f(a,b){for(var c="";c.length<b;)c+=a;return c}function g(a,b,c){var d,e,f=0;if(a.length)for(d=a.length;d>f;){if(e=b(a[f],f,a,c),void 0!==e)return e;f+=1}else for(f in a)if(a.hasOwnProperty(f)&&(e=b(a[f],f,a,c),void 0!==e))return e;return a}function h(a){function d(a){r.push(a)}function e(){return a.state=Z.RUNNING,U=a,a.startTime=Date.now(),a.parent&&(a.exit=t=a.parent.exit,u="(EXIT: exit inherited.)"),a.parent&&a.parent.element&&(a.element=a.parent.element),c(X.STEP_START,a),b("%sRUN:%s: %s",f("	",a.depth),a.type,a.label),l(),a}function g(){return R.walking&&c(X.STEP_UPDATE,a),(q=r[s])?(s+=1,q.run(),void 0):(h(),void 0)}function h(){a.state!==Z.COMPLETE&&(a.state=Z.COMPLETE,b("%sCOMPLETE:%s: %s",f("	",a.depth),a.type,a.label),c(X.STEP_END,a)),a.parent.next()}function i(b){return S.invoke(b,a,W)}function k(a){return a?!!i(a):!0}function l(){if(t?(a.label+="(EXIT: "+u+")",a.pass=!1,a.repeat=0):(i(a.method),a.pass=k(a.validate)),a.count+=1,a.timedOut=!p(a),a.repeat>a.count&&!a.pass&&!a.timedOut)b("%s%s: checking %s",f("	",a.depth),a.type,a.label),clearTimeout(V),c(X.STEP_UPDATE,a),V=Y.async?setTimeout(l,Y.interval):l();else{if(b('%s%s: %s, value:"%s" (%s)',f("	",a.depth),a.type,a.label,a.value,a.pass?"pass":"fail"),cb=a,R.pauseOnFail&&!a.pass&&(K(),c(X.STEP_UPDATE,a)),R.walking)return c(X.STEP_PAUSE,a),void 0;clearTimeout(V),c(X.STEP_UPDATE,a),V=Y.async?setTimeout(g,Y.interval):g()}}function m(b,c,d,e){c=c||function(){};var f={type:_.SUB_STEP,parentType:_.SUB_STEP,repeat:1,label:b||"CUSTOM",value:void 0,method:function(){return f.element=a.element,f.value=f.exec(c),f},validate:function(){return"boolean"==typeof d?d:d?f.exec(d):!0},timeout:e||Y.interval};return j(f,f.parent),f}function n(b,c,d){var e={type:_.SUB_STEP,parentType:_.SUB_STEP,repeat:1,label:b||"UNTIL",value:void 0,method:function(){return e.element=a.element,e},validate:function(){var a=c?e.exec(c):!0;return p(e)&&!a&&(e.repeat+=1),a},timeout:d||Y.interval};return j(e,e.parent),e}function o(){a.isDone=!0,a.repeat=0}var q,r=[],s=0,t=!1,u="",v=[_.SCENARIO,_.ROOT];for(a.type===_.ROOT?v=[_.ROOT]:a.type===_.SUB_STEP&&(v=[_.STEP,_.SUB_STEP]);a.parent&&-1===v.indexOf(a.parent.type);)a.parent=a.parent.parent;return a.parent||a.type===_.ROOT||(R.exit=a.exit=t=!0,u="Unable find step parent. Most likely caused by improper organization. Such as adding a find inside a scenario instead of inside a step."),a.id=Math.uuid(),a.state=Z.DORMANT,a.type=a.type||_.SUB_STEP,a.label=a.label||"no label",a.timeout=a.timeout||Y.defaultTimeout,a.method=a.method||function(){},a.validate=a.validate||function(){return!0},a.repeat=a.repeat||1,a.count=0,a.add=d,a.run=e,a.next=g,a.custom=m,a.until=n,a.done=o,a.exec=i,a.steps=r,a.depth=a.parent?a.parent.depth+1:0,a}function i(a){return a.type=a.type||_.SUB_STEP,a.parent=a.parent||U,U.add(h(a)),a}function j(a,b){return a.type=_.SUB_STEP,a.parent=b||U,i(a),s(a),a}function k(a,b){i({type:_.SCENARIO,parentType:_.SCENARIO,label:a,method:b})}function l(a,b,c,d){i({type:_.STEP,parentType:_.SCENARIO,label:a,method:b,validate:c,timeout:d})}function m(a){a=a||Y.interval,i({type:_.SUB_STEP,parentType:_.STEP,label:"wait "+a+"ms",method:null,repeat:1e4,validate:function(){return!p(this,!0)},timeout:a})}function n(a,b,c){i({type:_.SUB_STEP,parentType:_.STEP,label:"wait for "+a,method:null,repeat:1e4,validate:b,timeout:c})}function o(a,b){var c={type:_.SUB_STEP,parentType:_.STEP,label:'wait for "'+a+'" event.',repeat:1e4,scope:null,method:function(){c.scope||(c.element=c.parent.element||Y.rootElement,c.scope=c.element.scope(),c.scope.$on(a,function(){c.ngEvent=!0}))},validate:function(){return!!c.ngEvent},timeout:b||Y.timeouts.short};i(c)}function p(a,b){return a.timeout+a.startTime-(b?Y.interval:0)>Date.now()}function q(a,b,c,d){"trigger"===c&&(a.label='trigger "'+d[0].toUpperCase()+'"')}function r(a,b,c){return function(){var d=arguments,e={label:b.toUpperCase(),value:void 0,timeout:Y.interval,method:function(){var a=e.element;if(a){if(!a[b])throw new Error('Method "'+b+'" is not supported yet.');q(e,a,b,d),a[b].apply(a,d),c&&(e.value=a[b].apply(a,[]))}return e},validate:function(){return e.element&&e.element.length?c&&d.length?e.value===d[0]:!0:!1}};return j(e,a),e}}function s(a){t(a),u(a),g(R.elementMethods,v,a)}function t(a){for(var b=0,c=db.length;c>b;)a[db[b]]=r(a,db[b]),b+=1}function u(a){for(var b=0,c=db.length;c>b;)a[eb[b]]=r(a,eb[b],!0),b+=1}function v(a,b,c,d){"function"==typeof a?a(d):d[a.name]=a.method(d)}function w(a,b,c){var d="function"==typeof a?"(custom method)":a,e={type:_.SUB_STEP,parentType:_.STEP,repeat:1e4,label:c||'find: "'+d+'"',value:void 0,method:function(){return e.value=e.element=Y.rootElement.find("function"==typeof a?e.exec(a):a),e},validate:function(){var a=!!e.value.length;return e.label=a?e.label:'could not find "'+d+'"',a},timeout:b};return j(e),e}function x(a,b,c){var d=y(a,c);return a.apply(b,d.args)}function y(a,b){var c=a.toString(),d={map:{},args:[],locals:b},e=c.match(/\(.*\)/)[0].match(/([\$\w])+/gm);return e&&e.length&&g(e,z,d),d}function z(a,b,c,d){d.map[a]=d.locals[a]||window[a],d.args.push(d.map[a])}function A(a,b){return ab.push({name:a,scenario:b}),b}function B(){ab.length=0,R.scenarios={}}function C(a){R.options=angular.extend(Y,a)}function D(){var a=[];return g(ab,function(b){a.push(b.name)}),a}function E(a){return a=a.toLowerCase(),g(ab,function(b){return b.name.toLowerCase()===a?b:void 0})}function F(a){a="string"!=typeof a?a:E(a),i({type:_.SCENARIO,parentType:_.ROOT,label:"SCENARIO: "+a.name,method:a.scenario})}function G(){for(var a=0,b=ab.length;b>a;)F(ab[a]),a+=1}function H(a){d(),c(X.START),b("run"),e(),a?g(arguments,F):G(),U.run()}function I(){H.apply(R,arguments),K()}function J(){cb.next()}function K(){R.walking=!0}function L(){R.walking=!1,J()}function M(b,c){var d=0,e=a.util.array.toArray(arguments);for(e.shift(),e.shift();c>d;)b.apply({},[d].concat(e)),d+=1}function N(){function a(a){a.preventDefault(),a.stopImmediatePropagation()}function b(){l(),p=$('<div class="runner-overlay"><div class="runner-title">Type "runner.stop()" in the console to close the tests. <a href="javascript:void(0)" class="runner-close">X</a></div><div class="runner-content"></div></div>'),q=p.find(".runner-content"),p.click(a),p.mousedown(function(){u=!0}),p.mouseup(function(){u=!1}),$(document).blur(function(b){u&&a(b)}),r=$('<div class="runner-highlighter"></div>'),$("body").append(p),$("body").append(r),m()}function c(a){if(a&&a.length){var b=a.offset();r.removeClass("runner-highlighter-empty"),r.css({top:b.top,left:b.left,width:a.width(),height:a.height()})}else r.addClass("runner-highlighter-empty")}function d(a){return a.type===ux.runner.types.SUB_STEP}function e(a,b){var c=d(a.parent)&&d(a),e=$("#"+a.id);e.html((c&&" - "||"")+'<span class="runner-step-label">'+a.label+"</span>"+(a.count>1?' <span class="runner-step-count" title="repeat count">'+a.count+"</span>":"")+(a.timedOut?' <span class="runner-timed-out" title="timeout">timeout</span>':"")+(b?' <span class="runner-step-paused" title="paused">paused'+(R.pauseOnFail?" on fail":"")+"</span>":""))}function f(a,b){if(c(b.element),!$("#"+b.id).length){var f=d(b.parent),g=f?4:20*b.depth,h=d(b);h&&s&&s.depth>=b.depth&&q.append("<br/>"),q.append('<div id="'+b.id+'" class="runner-pending runner-'+b.type+(h?"-chain":"")+'" style="text-indent: '+g+'px;"></div>'),e(b)}}function g(a,b){e(b,!0),c(b.element)}function h(a,b){b.count>1&&e(b),c(b.element)}function i(a,b){var d=$("#"+b.id);d.addClass("runner-"+(b.pass?"pass":"fail")),e(b),c(b.element),j(),s=b}function j(){p.scrollTop(q.height())}function k(){j()}function l(){p&&(ux.runner.pause(),p.remove(),r.remove(),q=null,p=null,r=null,s=null,n())}function m(){var a=$("body");a.bind(R.events.STEP_START,f),a.bind(R.events.STEP_UPDATE,h),a.bind(R.events.STEP_END,i),a.bind(R.events.STEP_PAUSE,g),a.bind(R.events.DONE,k),$(".runner-close").click(R.stop)}function n(){var a=$("body");a.unbind(R.events.STEP_START,f),a.unbind(R.events.STEP_UPDATE,h),a.unbind(R.events.STEP_END,i),a.unbind(R.events.STEP_PAUSE,g),a.unbind(R.events.DONE,k),$(".runner-close").unbind("click",R.stop)}function o(){var a=$("body");a.ready(function(){var a=$("body");a.bind(R.events.START,b)})}var p,q,r,s,t={},u=!1;return t.start=b,t.stepStart=f,t.stepEnd=i,t.done=k,R.stop=l,o(),t}function O(a,b){this.el=a,a.scope&&(this.scope=a.scope());var c="text password number email url search tel";this.isEditable=/textarea|select/i.test(a[0].nodeName)||a[0].type&&c.indexOf(a[0].type.toLowerCase())>-1,this.isEditable&&(this.selStart=a.getSelectionStart()||0,this.selEnd=a.getSelectionEnd()||a.val().length,a.setSelection(this.selStart,this.selEnd),this.cursorPosition=this.selEnd),this.capsLocked=!1,b&&this.lock()}function P(a,b){var c={label:"sendKeys "+a,method:function(){c.element.length&&O.exec(c.element,a)},validate:function(){if(!c.element.length)return c.label="sendKeys failed because there is no element selected.",!1;if(b){var a="ng-model",d=c.element.attr(a)||c.element.attr("data-"+a);return c.value=d?c.element.scope().$eval(d):c.element.val(),c.value+""==b+""}return!0}};return c}function Q(a){for(var b=[],c=0,d=a.length;d>c;)b.push(a[c]),c+=1;return b}var R,S,T,U,V,W={},X={START:"runner:start",STEP_START:"runner:stepStart",STEP_UPDATE:"runner:stepUpdate",STEP_END:"runner:stepEnd",STEP_PAUSE:"runner:stepPause",DONE:"runner:done"},Y={async:!0,interval:100,defaultTimeout:1e3,timeouts:{mini:100,"short":1e3,medium:1e4,"long":3e4,forever:6e4}},Z={DORMANT:"dormant",RUNNING:"running",COMPLETE:"complete"},_={ROOT:"root",SCENARIO:"scenario",STEP:"step",SUB_STEP:"subStep"},ab=[],bb=!1,cb=null,db=["focus","blur","click","mousedown","mouseover","mouseup","select","touchstart","touchend","trigger"],eb=["val","text","html","scrollTop"];if(!Math.uuid){var fb=0;Math.uuid=function(){fb+=1;for(var a=fb.toString(36).toUpperCase();a.length<6;)a="0"+a;return a}}h.DORMANT=0,h.RUNNING=1,h.COMPLETE=2,R={getInjector:null,config:C,exit:!1,run:H,walk:I,walking:!1,pauseOnFail:!0,next:J,pause:K,resume:L,addScenario:A,clearScenarios:B,getScenarioNames:D,types:_,events:X,states:Z,createStep:i,createElementStep:j,args:[],elementMethods:[],scenarios:{},locals:W,dispatcher:null,each:g,repeat:M,steps:null},W.scenario=k,W.step=l,W.find=w,W.options=Y,W.wait=m,W.waitFor=n,W.waitForNgEvent=o,a.runner=R,$("body").ready(function(){R.options&&R.options.autoStart&&("function"==typeof R.options.autoStart?R.options.autoStart.apply(R,[]):setTimeout(R.run,1e3))}),N(),R.elementMethods.push(function(a){a.scrollUp=function(b){return a.custom("scrollUp",function(){return a.element.scrollTop(a.element.scrollTop()-b)})},a.scrollDown=function(b){return a.custom("scrollDown",function(){return a.element.scrollTop(a.element.scrollTop()+b)})}}),O.exec=function(a,b){var c,d,e=new O(a),f=b.match(/"[^"]+"|\w+/gim),g=0,h=f.length;for(e.lock();h>g;)d=f[g],c=d.match(/[^"]+/gim)[0],"delete"===c&&(c="del"),"function"==typeof e[c]?e[c]():e.type(c),e.release(),g+=1};var gb=O.prototype;gb.checkShiftKey=function(a){var b=a.toUpperCase();return b===a?!0:!1},gb.key={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,"*":106,"+":107,"-":109,".":110,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"=":187,",":188,"/":191,"\\":220},gb.type=function(a,b){var c,d,e;for(this.selStart!==this.selEnd&&(c=this.el.val(),c=c.substr(0,this.selStart)+c.substr(this.selEnd),this.el.val(c),this.selStart=this.selEnd=null),a=a||"",d=0,e=a.length;e>d;)this.punch(a.charAt(d),b),d+=1;return this},gb.punch=function(a,b){var c,d,e,f,g,h,i=this.el,j=this.scope,k=a.toLowerCase(),l=this.attr("ng-model");return b=b||{},"disabled"!==this.attr("disabled")&&(d=this.key[k],e=this.checkShiftKey(a),c=this.createEvent("keydown",{shiftKey:e,keyCode:d}),this.dispatchEvent(i[0],"keydown",c),this.isEditable&&1===a.length&&(f=this.cursorPosition,g=i.val(),g=g.substr(0,f)+a+g.substr(f),l&&j&&j.$eval(l+' = "'+g+'"'),i.val(g),this.cursorPosition+=1),c=this.createEvent("keyup",{shiftKey:e,keyCode:d}),this.dispatchEvent(i[0],"keyup",c),j&&((h=i.data("$ngModelController"))&&h.$setViewValue(i.val()),j.$$phase||j.$apply())),this},gb.attr=function(a){return this.el.attr(a)||this.el.attr("data-"+a)},gb.enter=function(a){return this.punch("enter",a),this},gb.left=function(a){return this.el,this.isEditable?this.cursorPosition-=1:this.punch("left",a),this},gb.up=function(a){return this.punch("up",a),this},gb.right=function(a){return this.el,this.isEditable?this.cursorPosition+=1:this.punch("right",a),this},gb.down=function(a){return this.punch("down",a),this},gb.home=function(a){return this.el,this.isEditable?this.cursorPosition=0:this.punch("home",a),this},gb.end=function(a){var b=this.el;return this.isEditable?this.cursorPosition=b.val().length:this.punch("home",a),this},gb.pageUp=function(a){return this.punch("pageup",a),this},gb.pageDown=function(a){return this.punch("pagedown",a),this},gb.del=function(a){if(this.isEditable){var b=this.el.val(),c=this.cursorPosition;this.el.val(b.substr(0,c)+b.substr(c+1))}else this.punch("delete",a);return this},gb.tab=function(a){return this.punch("tab",a),this},gb.backspace=function(a){if(this.isEditable){var b=this.el.val(),c=this.cursorPosition;this.el.val(b.substr(0,c-1)+b.substr(c)),this.cursorPosition=c-1}else this.punch("backspace",a);return this},gb.capsLock=function(){this.capsLocked=!this.capsLocked},gb.lock=function(){var a=$(document);return a.bind("mousedown",this.killEvent),a.bind("keydown",this.killEvent),a.bind("focus",this.killEvent),a.bind("blur",this.killEvent),this},gb.release=function(){var a=$(document);return a.unbind("mousedown",this.killEvent),a.unbind("keydown",this.killEvent),a.unbind("focus",this.killEvent),a.unbind("blur",this.killEvent),this},gb.killEvent=function(a){a.preventDefault(),a.stopImmediatePropagation()},gb.dispatchEvent=function(a,b,c){return a.dispatchEvent?a.dispatchEvent(c):a.fireEvent&&a.fireEvent("on"+b,c),c},gb.createEvent=function(a,b){var c,d;if(d=$.extend({bubbles:!0,cancelable:!0,view:window,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},b),$.isFunction(document.createEvent))try{c=document.createEvent("KeyEvents"),c.initKeyEvent(a,d.bubbles,d.cancelable,d.view,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,d.keyCode,d.charCode)}catch(e){c=document.createEvent("Events"),c.initEvent(a,d.bubbles,d.cancelable),$.extend(c,{view:d.view,ctrlKey:d.ctrlKey,altKey:d.altKey,shiftKey:d.shiftKey,metaKey:d.metaKey,keyCode:d.keyCode,charCode:d.charCode})}else document.createEventObject&&(c=document.createEventObject(),$.extend(c,d));return void 0!==$.browser&&($.browser.msie||$.browser.opera)&&(c.keyCode=d.charCode>0?d.charCode:d.keyCode,c.charCode=void 0),c},R.elementMethods.push({name:"sendKeys",method:function(a){return function(){var b=P.apply(null,arguments);return R.createElementStep(b,a),b}}}),function(a){"use strict";var b,c=jQuery.fn;c.getCursorPosition=function(){return 0===this.length?-1:a(this).getSelectionStart()},c.setCursorPosition=function(b){return 0===this.length?this:a(this).setSelection(b,b)},c.getSelection=function(){if(0===this.length)return-1;var b=a(this).getSelectionStart(),c=a(this).getSelectionEnd();return this[0].value.substring(b,c)},c.getSelectionStart=function(){if(0===this.length)return-1;b=this[0];var a,c=b.value.length;return b.createTextRange?(a=document.selection.createRange().duplicate(),a.moveEnd("character",b.value.length),""===a.text&&(c=b.value.length),c=b.value.lastIndexOf(a.text)):void 0!==b.selectionStart&&(c=b.selectionStart),c},c.getSelectionEnd=function(){if(0===this.length)return-1;b=this[0];var a,c=b.value.length;return b.createTextRange?(a=document.selection.createRange().duplicate(),a.moveStart("character",-b.value.length),""===a.text&&(c=b.value.length),c=b.value.lastIndexOf(a.text)):void 0!==b.selectionEnd&&(c=b.selectionEnd),c},c.setSelection=function(a,c){if(0===this.length)return this;if(b=this[0],b.createTextRange){var d=b.createTextRange();d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",a),d.select()}else b.setSelectionRange&&(b.focus(),b.setSelectionRange(a,c));return this}}(jQuery),R.elementMethods.push(function(a){a.sendMouse=function(b,c){c=c?"."+c:"";var d=a.trigger("mousedown"+c);return b&&d.focus(),d.trigger("mouseup"+c).trigger("click"+c)}}),R.elementMethods.push(function(a){a.sendTap=function(b,c){c=c?"."+c:"";var d=a.trigger("touchstart"+c);return b&&d.focus(),d.trigger("touchend"+c).trigger("click"+c)}}),R.elementMethods.push(function(a){a.toBe=function(b){var c={label:"toBe "+b,value:void 0,timeout:R.locals.options.interval,method:function(){},validate:function(){var d=a.value===b;return c.label=d?"toBe "+b:"expected "+a.value+" to be "+b,d}};return R.createElementStep(c,a)}}),a.util=a.util||{},a.util.array=ux.util.array||{},a.util.array.toArray=Q}(this.ux=this.ux||{},function(){return this}());