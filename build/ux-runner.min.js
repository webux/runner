/*
* uxRunner v.0.1.0
* (c) 2013, WebUX
* License: MIT.
*/
!function(a){function b(a,b,c){function d(a,b){var c,d;d=h[a],d&&(b?(c=d.indexOf(b),-1!==c&&d.splice(c,1)):d.length=0)}function e(a,b){return h[a]=h[a]||[],h[a].push(b),function(){d(a,b)}}function f(b,c){return b&&b.apply(a,c)}function g(a){if(h[a])for(var b=0,c=h[a],d=c.length;d>b;)f(c[b],arguments),b+=1}var h={};b&&c?(a.on=b[c.on]&&b[c.on].bind(b),a.off=b[c.off]&&b[c.off].bind(b),a.dispatch=b[c.dispatch].bind(b)):(a.on=e,a.off=d,a.dispatch=g)}function c(a){for(var b=[],c=0,d=a.length;d>c;)b.push(a[c]),c+=1;return b}function d(){_.debug&&console.log.apply(console,arguments)}function e(){_.dispatcher?_.dispatcher.dispatch.apply(_.dispatcher,arguments):_.dispatch.apply(_,arguments)}function f(){gb.window=gb.window||window,gb.rootElement=gb.rootElement||$(gb.window.document),ab=_.getInjector&&_.getInjector()||{invoke:C},_.locals.injector=ab}function g(){f(),_.walking=!1,_.exit=!1,h()}function h(){_.inPageMethods.length&&(k(_.inPageMethods,function(a){a.apply(_.options.window,[])}),_.inPageMethods.length=0)}function i(){var a={name:"all",type:ib.ROOT,label:"E2E Tests",parent:{type:ib.ROOT,depth:0,next:function(){d("All Complete"),e(fb.DONE)}}};bb=l(a),a.depth=0,cb=bb}function j(a,b){for(var c="";c.length<b;)c+=a;return c}function k(a,b,c){var d,e,f=0;if(a.length)for(d=a.length;d>f;){if(e=b(a[f],f,a,c),void 0!==e)return e;f+=1}else for(f in a)if(a.hasOwnProperty(f)&&(e=b(a[f],f,a,c),void 0!==e))return e;return a}function l(a){function b(a){q.push(a)}function c(){return a.state=hb.RUNNING,cb=a,a.startTime=Date.now(),a.parent&&(a.exit=s=a.parent.exit,t="(EXIT: exit inherited.)"),a.parent&&a.parent.element&&(a.element=a.parent.element),e(fb.STEP_START,a),d("%sRUN:%s: %s",j("	",a.depth),a.type,a.label),k(),a}function f(){return _.walking&&e(fb.STEP_UPDATE,a),(p=q[r])?(r+=1,p.run(),void 0):(g(),void 0)}function g(){a.state!==hb.COMPLETE&&(a.state=hb.COMPLETE,d("%sCOMPLETE:%s: %s",j("	",a.depth),a.type,a.label),e(fb.STEP_END,a)),a.onComplete&&a.onComplete(),a.parent.next()}function h(b){return ab.invoke(b,a,eb)}function i(a){return a?!!h(a):!0}function k(){if(s)a.label+="(EXIT: "+t+")",a.pass=!1,a.repeat=0;else if(lb&&(mb.push({label:a.label,type:a.type}),a.repeat=0),!lb||a.type!==ib.STEP&&a.type!==ib.SCENE)try{h(a.method),a.pass=lb?!0:i(a.validate)}catch(b){a.pass=lb||!1,a.label+=" ERROR: "+b.message,console.error(b.message)}else a.pass=!0;if(a.count+=1,a.timedOut=!u(a),a.repeat>a.count&&!a.pass&&!a.timedOut)d("%s%s: checking %s",j("	",a.depth),a.type,a.label),clearTimeout(db),e(fb.STEP_UPDATE,a),db=gb.async?setTimeout(k,gb.interval):k();else{if(d('%s%s: %s, value:"%s" (%s)',j("	",a.depth),a.type,a.label,a.value,a.pass?"pass":"fail"),kb=a,_.pauseOnFail&&!a.pass&&(Q(),e(fb.STEP_UPDATE,a)),_.walking)return e(fb.STEP_PAUSE,a),void 0;clearTimeout(db),e(fb.STEP_UPDATE,a),db=gb.async?setTimeout(f,gb.interval):f()}}function l(b,c,d,e){c=c||function(){};var f={type:ib.STEP,parentType:ib.STEP,repeat:1,label:b||"CUSTOM",value:void 0,method:function(){return f.element=a.element,f.value=f.exec(c),f},validate:function(){return"boolean"==typeof d?d:d?f.exec(d):!0},timeout:e||gb.interval};return n(f,f.parent),f}function m(b,c,d){var e={type:ib.STEP,parentType:ib.STEP,repeat:1,label:b||"UNTIL",value:void 0,method:function(){return e.element=a.element,e},validate:function(){var a=c?e.exec(c):!0;return u(e)&&!a&&(e.repeat+=1),a},timeout:d||gb.interval};return n(e,e.parent),e}function o(){a.isDone=!0,a.repeat=0}var p,q=[],r=0,s=!1,t="",v=[ib.SCENARIO,ib.ROOT];for(a.type===ib.ROOT?v=[ib.ROOT]:a.type===ib.STEP&&(v=[ib.SCENE,ib.STEP]);a.parent&&-1===v.indexOf(a.parent.type);)a.parent=a.parent.parent;return a.parent||a.type===ib.ROOT||(_.exit=a.exit=s=!0,t="Unable find step parent. Most likely caused by improper organization. Such as adding a find inside a scenario instead of inside a step."),a.id=Math.uuid(),a.state=hb.DORMANT,a.type=a.type||ib.STEP,a.label=a.label||"no label",a.timeout=a.timeout||gb.defaultTimeout,a.method=a.method||function(){},a.validate=a.validate||function(){return!0},a.repeat=a.repeat||1,a.count=0,a.add=b,a.run=c,a.next=f,a.custom=l,a.until=m,a.done=o,a.exec=h,a.steps=q,a.depth=a.parent?a.parent.depth+1:0,a}function m(a){return a.type=a.type||ib.STEP,a.parent=a.parent||cb,cb.add(l(a)),a}function n(a,b){return a.type=ib.STEP,a.parent=b||cb,m(a),x(a),a}function o(a,b){m({type:ib.SCENARIO,parentType:ib.SCENARIO,label:a,method:b})}function p(a,b,c,d){m({type:ib.SCENE,parentType:ib.SCENARIO,label:a,method:b,validate:c,timeout:d})}function q(a,b){m({type:ib.SCENE,parentType:ib.SCENARIO,label:a,method:function(){},validate:b})}function r(a){a=a||gb.interval,m({type:ib.STEP,parentType:ib.SCENE,label:"wait "+a+"ms",method:null,repeat:1e4,validate:function(){return!u(this,!0)},timeout:a})}function s(a,b,c){m({type:ib.STEP,parentType:ib.SCENE,label:"wait for "+a,method:null,repeat:1e4,validate:b,timeout:c})}function t(a,b){var c={type:ib.STEP,parentType:ib.SCENE,label:'wait for "'+a+'" event.',repeat:1e4,scope:null,method:function(){c.scope||(c.element=c.parent.element||gb.rootElement,c.scope=c.element.scope(),c.scope.$on(a,function(){c.ngEvent=!0}))},validate:function(){return!!c.ngEvent},timeout:b||gb.timeouts.short};m(c)}function u(a,b){return a.timeout+a.startTime-(b?gb.interval:0)>Date.now()}function v(a,b,c,d){"trigger"===c&&(a.label='trigger "'+d[0].toUpperCase()+'"')}function w(a,b,c){return function(){var d=arguments,e={label:b.toUpperCase(),value:void 0,timeout:gb.interval,method:function(){var a=e.element;if(a){if(!a[b])throw new Error('Method "'+b+'" is not supported yet.');v(e,a,b,d),a[b].apply(a,d),c&&(e.value=a[b].apply(a,[]))}return e},validate:function(){return e.element&&e.element.length?c&&d.length?e.value===d[0]:!0:!1}};return n(e,a),e}}function x(a){y(a),z(a),k(_.elementMethods,A,a)}function y(a){for(var b=0,c=_.jqMethods.length;c>b;)a[_.jqMethods[b]]=w(a,_.jqMethods[b]),b+=1}function z(a){for(var b=0,c=_.jqAccessors.length;c>b;)a[_.jqAccessors[b]]=w(a,_.jqAccessors[b],!0),b+=1}function A(a,b,c,d){"function"==typeof a?a(d):d[a.name]=a.method(d)}function B(a,b,c){var d="function"==typeof a?"(custom method)":a;c=c||'find: "'+d+'"';var e={type:ib.STEP,parentType:ib.SCENE,repeat:1e4,label:c,value:void 0,method:function(){return e.value=e.element=gb.rootElement.find("function"==typeof a?e.exec(a):a),e},validate:function(){var a=!!e.value.length;return e.label=a?c:'could not find "'+d+'"',a},timeout:b};return n(e),e}function C(a,b,c){var d=D(a,c);return a.apply(b,d.args)}function D(a,b){var c=a.toString(),d={map:{},args:[],locals:b},e=c.match(/\(.*\)/)[0].match(/([\$\w])+/gm);return e&&e.length&&k(e,E,d),d}function E(a,b,c,d){d.map[a]=d.locals[a]||window[a],d.args.push(d.map[a])}function F(a,b){return jb.push({name:a,scenario:b}),b}function G(){jb.length=0,_.scenarios={}}function H(a){_.options=$.extend(gb,a)}function I(){var a=[];return k(jb,function(b){a.push(b.name)}),a}function J(a){return a=a.toLowerCase(),k(jb,function(b){return b.name.toLowerCase()===a?b:void 0})}function K(a){a="string"!=typeof a?a:J(a),m({type:ib.SCENARIO,parentType:ib.ROOT,label:"SCENARIO: "+a.name,method:a.scenario})}function L(){for(var a=0,b=jb.length;b>a;)K(jb[a]),a+=1}function M(a){nb=arguments,_.stop&&_.stop(),g(),!lb&&_.onStart&&_.onStart(),e(fb.START),d("run"),i(),a?k(arguments,K):L(),cb.run()}function N(){M.apply(this,nb)}function O(){M.apply(_,arguments),Q()}function P(){kb.next()}function Q(){_.walking=!0}function R(){_.walking=!1,P()}function S(b,c){var d=0,e=a.util.array.toArray(arguments);for(e.shift(),e.shift();c>d;)b.apply({},[d].concat(e)),d+=1}function T(a,b,c,d){b=b||0,c=c||cb;var e=!1,f=function(){e=!0},g={type:ib.SCENE,parentType:ib.SCENARIO,label:"repeatUntil",parent:c,method:function(){},validate:function(){return ab.invoke(a,g,$.extend({count:b,done:f},eb)),e&&"repeatUntil"===g.label&&(g.label="repeatUntil - END"),void 0!==g.pass?g.pass:!0},onComplete:function(){lb&&(e=!0),e||T(a,b+1,c,g)},timeout:gb.interval};g.type=g.type||ib.STEP,g.parent=g.parent||cb,d?c.steps.splice(c.steps.indexOf(d)+1,0,l(g)):c.add(l(g)),g.done=f}function U(a){var b=gb.async;return mb=[],lb=!0,gb.async=!1,M(a),lb=!1,gb.async=b,mb}function V(a){var b=[];return W(jb.slice(0),b,a),b}function W(a,b,c){var d=U(a.shift());d.shift(),k(d,function(a){b.push(a)}),a.length&&setTimeout(W,0,a,b,c),c&&c(b,a.length)}function X(){function a(a){a.preventDefault(),a.stopImmediatePropagation()}function b(){$(".runner-overlay").length&&q(),G=0,H=0,A=$('<div class="runner-overlay"><div class="runner-title">RUNNER <div class="runner-button-bar"><a href="javascript:void(0)" class="runner-close runner-button" title="Close Runner">X</a> <a href="javascript:void(0)" class="runner-restart runner-button" title="Restart last run">&#x21bb;</a> <a href="javascript:void(0)" class="runner-pause runner-button" title="Pause Runner">||</a> <a href="javascript:void(0)" class="runner-next runner-button" title="Step Forward">&#x25B6;|</a> <a href="javascript:void(0)" class="runner-resume runner-button" title="Resume">&#x25B6;</a> <span class="runner-interval-label">Speed:</span><input type="text" class="runner-interval" disabled> <a href="javascript:void(0)" class="runner-plus runner-button" title="Increase Speed">+</a> <a href="javascript:void(0)" class="runner-minus runner-button" title="Decrease Speed">-</a> <a href="javascript:void(0)" class="runner-details runner-button" title="Click to show or hide details.">?</a> </div> <a href="javascript:void(0)" class="runner-complete"></a> </div><div class="runner-clear"></div><div class="runner-scroller"><div class="runner-content'+(_.compact?" compact":"")+'">'+'<div class="runner-content-title-spacer"></div>'+"</div>"+"</div>"+'<div class="runner-highlight-container"></div>'+"</div>"),B=A.find(".runner-content"),A.click(a),A.mousedown(function(){J=!0}),A.mouseup(function(){J=!1}),$(document).blur(function(b){J&&a(b)}),C=$('<div class="runner-highlighter"></div>'),E=$('<div class="runner-tooltip"><div class="runner-tooltip-arrow"></div><div class="runner-tooltip-content"></div></div>'),$("body").append(A),D=$(".runner-highlight-container"),D.append(C),D.append(E),e(),y()}function c(){ux.runner.walking?$(".runner-resume").removeClass("unpaused").addClass("paused"):$(".runner-resume").removeClass("paused").addClass("unpaused")}function d(){$(".runner-interval").val(ux.runner.options.interval)}function e(){var a,b=$("#targetFrame");b.length?(_.options.frame&&b.css(_.options.frame),a=b.offset(),a.position="absolute",a.width=b.width(),a.height=b.height(),D.css(a)):D.css({position:"absolute",top:0,left:0,width:"100%",height:"100%"})}function f(a){var b=a.element;if(c(),d(),e(),h(a,!1,E.find(".runner-tooltip-content")),b&&b.length&&b.offset()){var f=b.offset();C.removeClass("runner-highlighter-empty"),C.css({top:f.top,left:f.left,width:b.width(),height:b.height()}),E.css({top:f.top+b.height(),left:f.left+b.width()-E.width()})}else C.addClass("runner-highlighter-empty")}function g(a){return a.type===ux.runner.types.STEP}function h(a,b,c){var d=g(a.parent)&&g(a);c.html((d&&" - "||"")+'<span class="runner-step-label">'+a.label+"</span>"+(a.count>1?' <span class="runner-step-count" title="repeat count">'+a.count+"</span>":"")+(a.timedOut?' <span class="runner-timed-out" title="timeout">timeout</span>':"")+(b?' <span class="runner-step-paused runner-step-paused-'+(a.pass?"pass":"fail")+'" title="paused">paused'+(_.pauseOnFail&&!a.pass?" on fail":"")+"</span>":""))}function i(a,b){if(f(b),!$("#"+b.id).length){var c=g(b.parent),d=c?4:20*b.depth,e=g(b);e&&F&&F.depth>=b.depth&&b!==b.parent.steps[0]&&B.append('<div class="runner-break"></div>'),B.append('<div id="'+b.id+'" class="runner-pending runner-'+b.type+(e?"-chain":"")+'" style="margin-left: '+d+'px;margin-right: 0px;"></div>'),h(b,!1,$("#"+b.id))}}function j(a,b){s(),h(b,!0,$("#"+b.id)),f(b)}function k(a,b){b.count>1&&h(b,!1,$("#"+b.id)),f(b),n()}function l(a,b){var c=$("#"+b.id);c.addClass("runner-"+(b.pass?"pass":"fail")),c.attr("title",b.label),h(b,!1,$("#"+b.id)),f(b),o(),F=b,m(b)}function m(a){a.pass?G+=1:H+=1,n()}function n(a){var b=$(".runner-complete");b.removeClass("passed"),b.removeClass("failed"),b.removeClass("passed"),_.walking?b.addClass("paused"):H?b.addClass("failed"):b.addClass("passed"),a&&b.addClass("done"),b.html(G+" steps passed, "+H+" failed."+(a?" complete":_.walking?" paused":" running"))}function o(){A.find(".runner-scroller").scrollTop(B.height())}function p(){o(),n(!0)}function q(){A&&($(".runner-overlay").remove(),B=null,A=null,C=null,D=null,E=null,F=null,z())}function r(){A&&(q(),ux.runner.pause())}function s(){B.removeClass("compact")}function t(){B.addClass("compact")}function u(){return B.hasClass("compact")?s():t()}function v(){ux.runner.options.interval+=K}function w(){ux.runner.options.interval-=K,ux.runner.options.interval<K&&(ux.runner.options.interval=K)}function x(){q(),ux.runner.pause(),ux.runner.restart()}function y(){_.on(_.events.START,b),_.on(_.events.STEP_START,i),_.on(_.events.STEP_UPDATE,k),_.on(_.events.STEP_END,l),_.on(_.events.STEP_PAUSE,j),_.on(_.events.DONE,p),$(".runner-close").click(_.stop),$(".runner-restart").click(x),$(".runner-pause").click(_.pause),$(".runner-next").click(_.next),$(".runner-resume").click(_.resume),$(".runner-details").click(u),$(".runner-plus").click(v),$(".runner-minus").click(w)}function z(){_.off(_.events.START,b),_.off(_.events.STEP_START,i),_.off(_.events.STEP_UPDATE,k),_.off(_.events.STEP_END,l),_.off(_.events.STEP_PAUSE,j),_.off(_.events.DONE,p),$(".runner-close").unbind("click",_.stop),$(".runner-restart").unbind("click",x),$(".runner-pause").unbind("click",_.pause),$(".runner-next").unbind("click",_.next),$(".runner-resume").unbind("click",_.resume),$(".runner-details").unbind("click",u),$(".runner-plus").unbind("click",v),$(".runner-minus").unbind("click",w)}var A,B,C,D,E,F,G,H,I={},J=!1,K=10;return I.start=b,I.stepStart=i,I.stepEnd=l,I.done=p,_.stop=r,_.onStart=b,I}function Y(a,b){this.el=a,a.scope&&(this.scope=a.scope());var c="text password number email url search tel";this.isEditable=/textarea|select/i.test(a[0].nodeName)||a[0].type&&c.indexOf(a[0].type.toLowerCase())>-1,this.isEditable&&(this.selStart=a.getSelectionStart()||0,this.selEnd=a.getSelectionEnd()||a.val().length,a.setSelection(this.selStart,this.selEnd),this.cursorPosition=this.selEnd),this.capsLocked=!1,b&&this.lock()}function Z(a,b){var c={label:"sendKeys "+a,method:function(){c.element.length&&Y.exec(c.element,a)},validate:function(){if(!c.element.length)return c.label="sendKeys failed because there is no element selected.",!1;if(b){var a="ng-model",d=c.element.attr(a)||c.element.attr("data-"+a);return c.value=d?c.element.scope().$eval(d):c.element.val(),c.value+""==b+""}return!0}};return c}a.util=a.util||{},a.util.array=a.util.array||{},a.util.array.toArray=c;var _,ab,bb,cb,db,eb={},fb={START:"runner:start",STEP_START:"runner:stepStart",STEP_UPDATE:"runner:stepUpdate",STEP_END:"runner:stepEnd",STEP_PAUSE:"runner:stepPause",DONE:"runner:done"},gb={async:!0,interval:100,defaultTimeout:1e3,frame:{top:0,left:0,width:"100%",height:"100%"},timeouts:{mini:100,"short":1e3,medium:1e4,"long":3e4,forever:6e4}},hb={DORMANT:"dormant",RUNNING:"running",COMPLETE:"complete"},ib={ROOT:"root",SCENARIO:"scenario",SCENE:"scene",STEP:"step"},jb=[],kb=null,lb=!1,mb=[],nb=[];if(!Math.uuid){var ob=0;Math.uuid=function(){ob+=1;for(var a=ob.toString(36).toUpperCase();a.length<6;)a="0"+a;return a}}l.DORMANT=0,l.RUNNING=1,l.COMPLETE=2,_={getInjector:null,compact:!0,debug:!1,config:H,exit:!1,restart:N,run:M,walk:O,walking:!1,pauseOnFail:!0,next:P,pause:Q,resume:R,addScenario:F,clearScenarios:G,getScenarioNames:I,describeScenario:U,describeScenarios:V,types:ib,events:fb,states:hb,createStep:m,createElementStep:n,elementMethods:[],scenarios:{},locals:eb,dispatcher:null,each:k,repeat:S,inPageMethods:[],jqMethods:["focus","blur","click","mousedown","mouseover","mouseup","select","touchstart","touchend","trigger","hasClass"],jqAccessors:["val","text","html","scrollTop"]},eb.scenario=o,eb.repeatUntil=T,eb.scene=p,eb.assert=q,eb.find=B,eb.options=gb,eb.wait=r,eb.waitFor=s,eb.waitForNgEvent=t,b(_),a.runner=_,$("body").ready(function(){_.options&&_.options.autoStart&&("function"==typeof _.options.autoStart?(f(),_.options.autoStart.apply(_,[])):setTimeout(_.run,1e3))}),X(),_.elementMethods.push(function(a){a.scrollUp=function(b){return a.custom("scrollUp",function(){return a.element.scrollTop(a.element.scrollTop()-b)})},a.scrollDown=function(b){return a.custom("scrollDown",function(){return a.element.scrollTop(a.element.scrollTop()+b)})}}),Y.exec=function(a,b){var c,d,e=new Y(a),f=b.match(/"[^"]+"|\w+/gim),g=0,h=f.length;for(e.lock();h>g;)d=f[g],c=d.match(/[^"]+/gim)[0],"delete"===c&&(c="del"),"function"==typeof e[c]?e[c]():e.type(c),e.release(),g+=1};var pb=Y.prototype;pb.checkShiftKey=function(a){var b=a.toUpperCase();return b===a?!0:!1},pb.key={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,"*":106,"+":107,"-":109,".":110,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"=":187,",":188,"/":191,"\\":220},pb.type=function(a,b){var c,d,e;for(this.selStart!==this.selEnd&&(c=this.el.val(),c=c.substr(0,this.selStart)+c.substr(this.selEnd),this.el.val(c),this.selStart=this.selEnd=null),a=a||"",d=0,e=a.length;e>d;)this.punch(a.charAt(d),b),d+=1;return this},pb.punch=function(a,b){var c,d,e,f,g,h,i=this.el,j=this.scope,k=a.toLowerCase(),l=this.attr("ng-model");return b=b||{},"disabled"!==this.attr("disabled")&&(d=this.key[k],e=this.checkShiftKey(a),c=this.createEvent("keydown",{shiftKey:e,keyCode:d}),this.dispatchEvent(i[0],"keydown",c),this.isEditable&&1===a.length&&(f=this.cursorPosition,g=i.val(),g=g.substr(0,f)+a+g.substr(f),l&&j&&j.$eval(l+' = "'+g+'"'),i.val(g),this.cursorPosition+=1),c=this.createEvent("keyup",{shiftKey:e,keyCode:d}),this.dispatchEvent(i[0],"keyup",c),j&&((h=i.data("$ngModelController"))&&h.$setViewValue(i.val()),this.dispatchEvent(i[0],"change",this.createEvent("change",{})),j.$$phase||j.$apply())),this},pb.attr=function(a){return this.el.attr(a)||this.el.attr("data-"+a)},pb.enter=function(a){return this.punch("enter",a),this},pb.left=function(a){return this.el,this.isEditable?this.cursorPosition-=1:this.punch("left",a),this},pb.up=function(a){return this.punch("up",a),this},pb.right=function(a){return this.el,this.isEditable?this.cursorPosition+=1:this.punch("right",a),this},pb.down=function(a){return this.punch("down",a),this},pb.home=function(a){return this.el,this.isEditable?this.cursorPosition=0:this.punch("home",a),this},pb.end=function(a){var b=this.el;return this.isEditable?this.cursorPosition=b.val().length:this.punch("home",a),this},pb.pageUp=function(a){return this.punch("pageup",a),this},pb.pageDown=function(a){return this.punch("pagedown",a),this},pb.del=function(a){if(this.isEditable){var b=this.el.val(),c=this.cursorPosition;this.el.val(b.substr(0,c)+b.substr(c+1))}else this.punch("delete",a);return this},pb.tab=function(a){return this.punch("tab",a),this},pb.backspace=function(a){if(this.isEditable){var b=this.el.val(),c=this.cursorPosition;this.el.val(b.substr(0,c-1)+b.substr(c)),this.cursorPosition=c-1}else this.punch("backspace",a);return this},pb.capsLock=function(){this.capsLocked=!this.capsLocked},pb.lock=function(){var a=$(document);return a.bind("mousedown",this.killEvent),a.bind("keydown",this.killEvent),a.bind("focus",this.killEvent),a.bind("blur",this.killEvent),this},pb.release=function(){var a=$(document);return a.unbind("mousedown",this.killEvent),a.unbind("keydown",this.killEvent),a.unbind("focus",this.killEvent),a.unbind("blur",this.killEvent),this},pb.killEvent=function(a){a.preventDefault(),a.stopImmediatePropagation()},pb.dispatchEvent=function(a,b,c){return a.dispatchEvent?a.dispatchEvent(c):a.fireEvent&&a.fireEvent("on"+b,c),c},pb.createEvent=function(a,b){var c,d;if(d=$.extend({bubbles:!0,cancelable:!0,view:window,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},b),$.isFunction(document.createEvent))if(-1!==a.indexOf("key"))try{c=document.createEvent("KeyEvents"),c.initKeyEvent(a,d.bubbles,d.cancelable,d.view,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,d.keyCode,d.charCode)}catch(e){c=document.createEvent("Events"),c.initEvent(a,d.bubbles,d.cancelable),$.extend(c,{view:d.view,ctrlKey:d.ctrlKey,altKey:d.altKey,shiftKey:d.shiftKey,metaKey:d.metaKey,keyCode:d.keyCode,charCode:d.charCode})}else c=document.createEvent("HTMLEvents"),c.initEvent(a,!1,!0);else document.createEventObject&&(c=document.createEventObject(),$.extend(c,d));return void 0!==$.browser&&($.browser.msie||$.browser.opera)&&(c.keyCode=d.charCode>0?d.charCode:d.keyCode,c.charCode=void 0),c},_.elementMethods.push({name:"sendKeys",method:function(a){return function(){var b=Z.apply(null,arguments);return _.createElementStep(b,a),b}}}),_.inPageMethods.push(function(){"use strict";var a,b=this.jQuery.fn;b.getCursorPosition=function(){return 0===this.length?-1:$(this).getSelectionStart()},b.setCursorPosition=function(a){return 0===this.length?this:$(this).setSelection(a,a)},b.getSelection=function(){if(0===this.length)return-1;var a=$(this).getSelectionStart(),b=$(this).getSelectionEnd();return this[0].value.substring(a,b)},b.getSelectionStart=function(){if(0===this.length)return-1;a=this[0];var b,c=a.value.length;return a.createTextRange?(b=document.selection.createRange().duplicate(),b.moveEnd("character",a.value.length),""===b.text&&(c=a.value.length),c=a.value.lastIndexOf(b.text)):void 0!==a.selectionStart&&(c=a.selectionStart),c},b.getSelectionEnd=function(){if(0===this.length)return-1;a=this[0];var b,c=a.value.length;return a.createTextRange?(b=document.selection.createRange().duplicate(),b.moveStart("character",-a.value.length),""===b.text&&(c=a.value.length),c=a.value.lastIndexOf(b.text)):void 0!==a.selectionEnd&&(c=a.selectionEnd),c},b.setSelection=function(b,c){if(0===this.length)return this;if(a=this[0],a.createTextRange){var d=a.createTextRange();d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",b),d.select()}else a.setSelectionRange&&(a.focus(),a.setSelectionRange(b,c));return this}}),_.elementMethods.push(function(a){a.sendMouse=function(b,c){c=c?"."+c:"";var d=a.trigger("mousedown"+c);return b&&d.focus(),d.trigger("mouseup"+c).trigger("click"+c)}}),_.elementMethods.push(function(a){a.sendTap=function(b,c){c=c?"."+c:"";var d=a.trigger("touchstart"+c);return b&&d.focus(),d.trigger("touchend"+c).trigger("click"+c)}}),_.elementMethods.push(function(a){a.toBe=function(b){var c={label:"toBe "+b,value:void 0,timeout:_.locals.options.interval,method:function(){},validate:function(){var d=$.trim(a.value)===b;return c.label=d?"toBe "+b:"expected "+a.value+" to be "+b,d}};return _.createElementStep(c,a)}})}(this.ux=this.ux||{},function(){return this}());